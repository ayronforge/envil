---
title: 1Password
description: Resolve environment variables from 1Password vaults using the SDK's batch resolution.
order: 13
---

import TypeTable from "@/components/docs/TypeTable.astro";
import Callout from "@/components/docs/Callout.astro";
import Tabs from "@/components/docs/Tabs.astro";

## Installation

Install the 1Password SDK peer dependency:

<Tabs items={["npm", "pnpm", "bun", "yarn"]} persist="pkg-manager">
  <div>
    ```bash
    npm install @1password/sdk
    ```
  </div>
  <div>
    ```bash
    pnpm add @1password/sdk
    ```
  </div>
  <div>
    ```bash
    bun add @1password/sdk
    ```
  </div>
  <div>
    ```bash
    yarn add @1password/sdk
    ```
  </div>
</Tabs>

## Basic usage

```ts
import { createEnv, requiredString } from "@ayronforge/better-env"
import { fromOnePassword } from "@ayronforge/better-env/1password"
import { Effect } from "effect"

const envEffect = createEnv({
  server: {
    DATABASE_URL: requiredString,
    API_KEY: requiredString,
  },
  resolvers: [
    fromOnePassword({
      secrets: {
        DATABASE_URL: "op://vault/database/url",
        API_KEY: "op://vault/api/credential",
      },
    }),
  ],
})

const env = await Effect.runPromise(envEffect)
```

## Options

<TypeTable rows={[
  { name: "secrets", type: "Record<string, string>", required: true, description: "Map of env var names to 1Password secret references (op:// URIs)." },
  { name: "serviceAccountToken", type: "string", description: "1Password service account token. Falls back to OP_SERVICE_ACCOUNT_TOKEN env var." },
]} />

<Callout type="note">
  Either `serviceAccountToken` or the `OP_SERVICE_ACCOUNT_TOKEN` environment variable must be available. If neither is provided, the resolver fails with a `ResolverError`.
</Callout>

## Secret references

1Password secret references use the `op://` URI format:

```
op://vault-name/item-name/field-name
```

For example:

- `op://Production/Database/password` — the `password` field from the `Database` item in the `Production` vault
- `op://Shared/API Keys/credential` — the `credential` field from the `API Keys` item

## Service account token

The resolver authenticates using a 1Password service account token. You can provide it in two ways:

1. **Directly in options:**

   ```ts
   fromOnePassword({
     secrets: { ... },
     serviceAccountToken: "ops_...",
   })
   ```

2. **Via environment variable:**

   ```bash
   export OP_SERVICE_ACCOUNT_TOKEN="ops_..."
   ```
