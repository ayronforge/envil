---
import { presets } from "../data/content.ts";
import { getIcon } from "../lib/utils.ts";
import { highlightCode } from "../lib/highlight.ts";
import { PresetSelector } from "./preset-selector.tsx";

const invertIcon = (p: typeof presets[number]) =>
  "invertIcon" in p && !!p.invertIcon;

const iconsLight = await Promise.all(presets.map((p) => getIcon(p.icon, "black")));
const iconsDark = await Promise.all(presets.map((p) => getIcon(p.icon, "white", {invert: invertIcon(p) })));

const presetData = presets.map((p, i) => ({
  name: p.name,
  prefix: p.prefix,
  code: p.code,
  highlightedCode: highlightCode(p.code),
  iconLight: iconsLight[i].url,
  iconDark: iconsDark[i].url,
  invertDark: iconsDark[i].invert,
}));
---

<section class="relative pb-28 px-6 lg:px-12">
  <div class="max-w-6xl mx-auto">
    <div class="text-center mb-16">
      <h2 class="text-3xl sm:text-4xl font-extrabold tracking-tight mb-4">Framework Presets</h2>
      <p class="text-muted text-lg max-w-xl mx-auto">Get started instantly with pre-configured presets for popular frameworks.</p>
    </div>

    <PresetSelector client:visible presets={presetData} />
  </div>
</section>

<style>
  :global(.preset-code-block) {
    box-shadow: 0 0 60px rgba(234, 107, 62, 0.08), 0 20px 40px rgba(0, 0, 0, 0.1);
  }
  :global([data-theme="dark"] .preset-code-block) {
    border: 1px solid rgba(255, 255, 255, 0.08);
    box-shadow: 0 0 60px rgba(234, 107, 62, 0.1), 0 20px 40px rgba(0, 0, 0, 0.3);
  }
</style>
